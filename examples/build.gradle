apply plugin: 'java'

repositories {
	mavenLocal()
	mavenCentral()
    jcenter()         
}

dependencies {
	compile "com.flipkart.grpc-jexpress:runtime:1.0"    
    compile "io.grpc:examples:1.10.0" 
}

apply plugin: 'application'
startScripts.enabled = false

task helloWorldServer(type: CreateStartScripts) {
  mainClassName = 'com.flipkart.gjex.examples.helloworld.HelloWorldApplication'
  applicationName = 'hello-world-server'
  outputDir = new File(project.buildDir, 'tmp')
  classpath = jar.outputs.files + project.configurations.runtime
}

task helloWorldClient(type: CreateStartScripts) {
  mainClassName = 'io.grpc.examples.helloworld.HelloWorldClient'
  applicationName = 'hello-world-client'
  outputDir = new File(project.buildDir, 'tmp')
  classpath = jar.outputs.files + project.configurations.runtime
}

applicationDistribution.into('bin') {
  from(helloWorldServer)
  from(helloWorldClient)
  fileMode = 0755
}

task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
}
artifacts {
    archives sourcesJar
}	
